{"version":3,"sources":["components/ModalOverlay/ModalOverlay.module.css","components/OrderList/OrderList.module.css","pages/not-found.module.css","pages/feed.module.css","services/hooks.ts","services/slices/burgerConstructor.ts","services/slices/burgerIngredients.ts","services/utils.ts","services/slices/user.ts","services/slices/ws.ts","services/slices/wsUser.ts","services/slices/index.ts","components/AppHeader/AppHeader.tsx","components/ModalOverlay/ModalOverlay.tsx","components/Modal/Modal.tsx","images/done.png","components/OrderDetails/OrderDetails.tsx","components/IngredientDetails/IngredientDetails.tsx","components/ProtectedRoute/ProtectedRoute.tsx","components/BurgerIngredients/BurgerIngredient.tsx","components/BurgerIngredients/BurgerIngredients.tsx","components/BurgerConstructor/BurgerConstructorItem.tsx","components/BurgerConstructor/BurgerConstructor.tsx","pages/home.tsx","components/OrderInfo/OrderInfo.tsx","pages/login.tsx","pages/register.tsx","pages/forgot_password.tsx","pages/reset_password.tsx","components/ProfileForm/ProfileForm.tsx","components/OrderListItem/OrderListItem.tsx","components/OrderList/OrderList.tsx","pages/profile.tsx","pages/not-found.tsx","pages/feed.tsx","components/App/App.tsx","reportWebVitals.ts","services/middleware/socketMiddleware.ts","services/store.ts","index.tsx","components/IngredientDetails/IngredientDetails.module.css","components/OrderInfo/OrderInfo.module.css","components/AppHeader/AppHeader.module.css","components/OrderListItem/OrderListItem.module.css","pages/profile.module.css","components/BurgerIngredients/BurgerIngredients.module.css","components/BurgerIngredients/BurgerIngredient.module.css","pages/login.module.css","pages/register.module.css","components/ProfileForm/ProfileForm.module.css","components/App/App.module.css","components/OrderDetails/OrderDetails.module.css","components/BurgerConstructor/BurgerConstructor.module.css","pages/home.module.css","pages/reset_password.module.css","pages/forgot_password.module.css","components/Modal/Modal.module.css","components/BurgerConstructor/BurgerConstructorItem.module.css"],"names":["module","exports","useAppDispatch","useDispatch","useAppSelector","useSelector","lastId","initialState","bun","components","qty","burgerConstructorSlice","createSlice","name","reducers","addIngredient","state","ingredient","payload","type","_id","push","id","removeIngredient","filter","item","index","updateComponentsSort","fromIndex","toIndex","updatedComponents","dragComponent","splice","reset","actions","getData","createAsyncThunk","url","a","dispatch","request","fetch","response","json","result","success","data","failed","burgerIngredientsSlice","dataRequest","dataFailed","currentTab","action","updateCurrentTab","tab","extraReducers","builder","addCase","rejected","console","log","error","getCookie","matches","document","cookie","match","RegExp","replace","decodeURIComponent","undefined","setCookie","value","props","exp","expires","d","Date","setTime","getTime","toUTCString","updatedCookie","encodeURIComponent","propName","propValue","deleteCookie","humanReadableDate","comparisonDate","today","yesterday","subDays","isSameDay","differenceInDays","daysWord","format","burgerAPI","isRequest","isFailed","isAuth","form","email","password","register","method","headers","body","JSON","stringify","accessToken","slice","refreshToken","setUserName","user","login","logout","_","token","updateUserName","getUserData","setUserFormData","setUserData","formData","userSlice","updateUserFormData","key","wsSlice","orders","wsConnected","wsConnectionStart","wsConnectionSuccess","wsConnectionClosed","wsConnectionError","wsGetMessage","wsUserSlice","wsUserConnectionStart","wsUserConnectionSuccess","wsUserConnectionClosed","wsUserConnectionError","wsUserGetMessage","order","params","orderRequest","orderURL","ingredients","orderSuccess","orderNumber","number","orderFailed","orderSlice","orderClose","rootReducer","reducer","burgerConstructorReducer","burgerIngredientsReducer","wsReducer","ordersUser","wsUserReducer","AppHeader","loginPath","className","appHeaderStyles","header","to","exact","activeClassName","ModalOverlay","modalOverlayStyles","overlay","onClick","children","modalRoot","getElementById","Modal","title","onClose","handlerCloseButton","React","useCallback","e","useEffect","addEventListener","removeEventListener","ReactDOM","createPortal","target","currentTarget","modalStyles","OrderDetails","orderDetailsStyles","container","src","doneImg","alt","dataURL","IngredientDetails","ingredientId","useParams","length","find","ingredientDetailsStyles","image_large","description","calories","proteins","fat","carbohydrates","ProtectedRoute","path","useState","isLoading","setIsLoading","hasAccessToken","hasRefreshToken","styles","loader_no_offset_top","color","height","width","render","location","pathname","from","BurgerIngredient","cnt","price","useDrag","dragRef","burgerIngredientStyles","ref","count","size","memo","BurgerIngredients","useLocation","setTab","ulIngredients","ingredientsBlock","scrollTo","offsetTop","sortedData","typeIngredient","forEach","burgerIngredientsStyles","active","onScroll","parentTop","getBoundingClientRect","y","saucesTop","querySelector","mainsTop","map","background","BurgerConstructorItem","history","useHistory","moveComponent","image","useRef","useDrop","accept","hover","monitor","current","dragIndex","hoverIndex","hoverBoundingRect","hoverMiddleY","bottom","top","clientOffset","getClientOffset","hoverClientY","drop","drag","burgerConstructorItemStyles","text","thumbnail","handleClose","handleRemoveIngredient","BurgerConstructor","total","reduce","sum","handleOpenOrderModal","burgerConstructorStyles","isLocked","HomePage","dropTarget","OrderInfo","orderId","ordersCommon","orderUser","matchPath","strict","indexOf","wrapper","composition","found","image_mobile","img","align_center","status","style","statusText","arr","ingredient_info","ingredient_icon_name","ingredient_icon","ingredient_qty_price","printComposition","time_total","createdAt","LoginPage","setFormData","onChangeField","element","onSubmit","preventDefault","onChange","link","RegisterPage","onChangeFormData","placeholder","errorText","ForgotPasswordPage","setEmail","then","catch","err","ResetPasswordPage","setPassword","setToken","onSubmitForm","message","ProfileForm","onFieldChange","input_wrapper","buttons_wrapper","OrderListItem","showStatus","componentIconArr","showMore","extraCnt","component","order_number_date","order_components_total","order_icons","order_component_icon","order_component_icon_more","zIndex","more_items","order_total","OrderList","orderList","order_list","ProfilePage","left_panel","nav_link","activeStyle","right_panel","NotFound404","Feed","ordersState","ordersResponse","totalToday","done","pending","feed_wrapper","feed_inner","feed_order_status","feed_order_status_type","feed_order_status_type_list","feed_order_cyan_colored","text_shadow","App","loader","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","socketMiddleware","wsUrl","wsActions","checkToken","store","socket","next","WebSocket","onopen","onerror","onmessage","event","parsedData","parse","restParsedData","onclose","configureStore","middleware","getDefaultMiddleware","concat","thunk","devTools","process","StrictMode","DndProvider","backend","HTML5Backend"],"mappings":"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","file":"static/js/main.84f43197.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"ModalOverlay_overlay__lrtDa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"order_list\":\"OrderList_order_list__3y85u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"not-found_wrapper__AsGvC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"feed_wrapper__1AZ_g\",\"feed_wrapper\":\"feed_feed_wrapper__-7k-b\",\"feed_inner\":\"feed_feed_inner__2iAV3\",\"feed_order_status\":\"feed_feed_order_status__1A2px\",\"feed_order_status_type\":\"feed_feed_order_status_type__1OgGJ\",\"feed_order_cyan_colored\":\"feed_feed_order_cyan_colored__1fJLq\",\"feed_order_status_type_list\":\"feed_feed_order_status_type_list__2rfBO\",\"text_shadow\":\"feed_text_shadow__3F9hu\"};","import {TypedUseSelectorHook, useDispatch, useSelector} from \"react-redux\";\r\nimport {AppDispatch, RootState} from \"./store\";\r\n\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\nimport {IIngredient} from \"../types\";\r\n\r\nlet lastId = 0;\r\n\r\ntype TIngredientWrapper = {\r\n  id: number;\r\n  ingredient: IIngredient;\r\n};\r\n\r\nexport type TBurgerConstructorState = {\r\n  bun: IIngredient | null;\r\n  components: Array<TIngredientWrapper>;\r\n  qty: {\r\n    [key: string]: number\r\n  }\r\n};\r\n\r\nexport const initialState: TBurgerConstructorState = {\r\n  bun: null,\r\n  components: [],\r\n  qty: {}\r\n};\r\n\r\nconst burgerConstructorSlice = createSlice({\r\n  name: 'burgerConstructor',\r\n  initialState,\r\n  reducers: {\r\n    addIngredient(state, {payload: {ingredient}}) {\r\n      // console.log(arguments);\r\n      if (ingredient.type === 'bun') {\r\n        if (state.bun) { // Удалим информацию о количестве текущих булок\r\n          state.qty[state.bun._id] = 0;\r\n        }\r\n\r\n        state.bun = ingredient  // Перезапишем булки\r\n        state.qty[ingredient._id] = 2;\r\n      } else {\r\n        state.components.push({\r\n          id: lastId++,\r\n          ingredient\r\n        });\r\n\r\n        state.qty[ingredient._id]\r\n          ? state.qty[ingredient._id] = ++state.qty[ingredient._id]\r\n          : state.qty[ingredient._id] = 1;\r\n      }\r\n    },\r\n    removeIngredient(state, {payload}) {\r\n      let ingredient: IIngredient;\r\n      state.components = state.components.filter((item: TIngredientWrapper, index) => {\r\n        if (index === payload.index) {\r\n          ingredient = item.ingredient;\r\n          state.qty[ingredient._id] = --state.qty[ingredient._id];\r\n        }\r\n        return index !== payload.index;\r\n      });\r\n    },\r\n    updateComponentsSort(state, {payload: {fromIndex, toIndex}}) {\r\n      // Получили массив не Proxy-элментов\r\n      const updatedComponents = [...state.components];\r\n      const dragComponent = updatedComponents[fromIndex];\r\n      updatedComponents.splice(fromIndex, 1); // удалили drag-компонент\r\n      updatedComponents.splice(toIndex, 0, dragComponent); // вставили его в drop-место\r\n      // модифицировали массив и вернули его в state.components\r\n      state.components = updatedComponents;\r\n    },\r\n    reset() {\r\n      return initialState;\r\n    }\r\n  },\r\n});\r\nexport const {addIngredient, removeIngredient, updateComponentsSort, reset} = burgerConstructorSlice.actions;\r\n\r\n\r\n\r\nexport default burgerConstructorSlice.reducer;\r\n","import {createAsyncThunk, createSlice} from '@reduxjs/toolkit';\r\nimport {IIngredient} from \"../types\";\r\n\r\ntype TBurgerIngredientsState = {\r\n  data: Array<IIngredient>;\r\n  dataRequest: boolean;\r\n  dataFailed: boolean;\r\n  currentTab: string;\r\n};\r\n\r\nconst initialState: TBurgerIngredientsState = {\r\n  data: [],\r\n  dataRequest: false,\r\n  dataFailed: false,\r\n  currentTab: 'buns'\r\n};\r\n\r\nconst getData = createAsyncThunk(\r\n    'burgerIngredients/getData',\r\n    async (url: string, {dispatch}) => {\r\n        dispatch(request());\r\n        const response = await fetch(url);\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            dispatch(success({data: result.data}))\r\n        } else {\r\n            dispatch(failed());\r\n        }\r\n    }\r\n)\r\n\r\nconst burgerIngredientsSlice = createSlice({\r\n  name: 'burgerIngredients',\r\n  initialState,\r\n  reducers: {\r\n    request(state) {\r\n      state.dataRequest = true;\r\n      state.dataFailed = false;\r\n    },\r\n    success(state, action) {\r\n      state.dataRequest = false;\r\n      state.data = action.payload.data;\r\n    },\r\n    failed(state) {\r\n      state.dataRequest = false;\r\n      state.dataFailed = true;\r\n    },\r\n    updateCurrentTab(state, {payload}) {\r\n      state.currentTab = payload.tab;\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase(getData.rejected, (state, action) => {\r\n        console.log(action.error);\r\n        failed();\r\n      }\r\n    )\r\n  }\r\n});\r\n\r\nexport const {request, success, failed, updateCurrentTab} = burgerIngredientsSlice.actions;\r\n\r\nexport {getData};\r\n\r\nexport default burgerIngredientsSlice.reducer;\r\n","import {differenceInDays, isSameDay, format, subDays} from 'date-fns';\r\n\r\nexport function getCookie(name: string) {\r\n  const matches = document.cookie.match(\r\n    new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()[]\\\\\\/+^])/g, '\\\\$1') + '=([^;]*)')\r\n  );\r\n  return matches ? decodeURIComponent(matches[1]) : undefined;\r\n}\r\n\r\nexport function setCookie(name: string, value: string | null, props?: {[key: string]: number | Date | string | boolean}) {\r\n  props = props || {};\r\n  let exp = props.expires;\r\n  if (typeof exp == 'number' && exp) {\r\n    const d = new Date();\r\n    d.setTime(d.getTime() + exp * 1000);\r\n    exp = props.expires = d;\r\n  }\r\n  if (exp instanceof Date) {\r\n    exp = exp.toUTCString();\r\n  }\r\n  if (value === null) {\r\n    value = '';\r\n  }\r\n  value = encodeURIComponent(value);\r\n  let updatedCookie = name + '=' + value;\r\n  updatedCookie += ';path=/'; // Создаём куки с path в корне. В отладчике были замечены случаи, когда куки создавались\r\n  // с разными path, это приводило к невозможности разлогина\r\n  for (const propName in props) {\r\n    updatedCookie += '; ' + propName;\r\n    const propValue = props[propName];\r\n    if (propValue !== true) {\r\n      updatedCookie += '=' + propValue;\r\n    }\r\n  }\r\n  document.cookie = updatedCookie;\r\n}\r\n\r\nexport function deleteCookie(name: string) {\r\n  setCookie(name, null, {expires: new Date(0)});\r\n}\r\n\r\n\r\nexport function humanReadableDate(comparisonDate: Date) {\r\n  const today = new Date();\r\n  const yesterday = subDays(today, 1);\r\n\r\n  let result;\r\n  if (isSameDay(comparisonDate, today)) {\r\n    result = 'Сегодня';\r\n  } else if (isSameDay(comparisonDate, yesterday)) {\r\n    result = 'Вчера';\r\n  } else if (differenceInDays(today, comparisonDate) <= 7) {\r\n    const daysWord = differenceInDays(today, comparisonDate) <= 5 ? 'дня' : 'дней';\r\n    result = `${differenceInDays(today, comparisonDate)} ${daysWord} назад`;\r\n  } else {\r\n    result = format(comparisonDate, 'dd.MM.yyyy')\r\n  }\r\n  result += `, ${format(comparisonDate, 'HH:mm')} i-${format(comparisonDate, 'O')}`;\r\n  return result;\r\n}\r\n\r\n\r\nexport const burgerAPI = 'https://norma.nomoreparties.space/api';","import {createAsyncThunk, createSlice} from '@reduxjs/toolkit';\r\nimport {deleteCookie, getCookie, setCookie, burgerAPI} from \"../utils\";\r\n\r\ntype TUserState = {\r\n    isRequest: boolean;\r\n    isFailed: boolean;\r\n    isAuth: boolean;\r\n    name: string;\r\n    form: {\r\n        name: string;\r\n        email: string;\r\n        password: string\r\n    }\r\n};\r\n\r\nconst initialState: TUserState = {\r\n    isRequest: false,\r\n    isFailed: false,\r\n    isAuth: !!getCookie('accessToken'),\r\n    name: '',\r\n    form: {\r\n        name: '',\r\n        email: '',\r\n        password: ''\r\n    }\r\n}\r\n\r\nconst register = createAsyncThunk(\r\n    'user/register',\r\n    async ({password, name, email}: TRegisterFormFields, {dispatch}) => {\r\n        dispatch(request());\r\n        const response = await fetch(`${burgerAPI}/auth/register`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                password,\r\n                name,\r\n                email\r\n            })\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            setCookie('accessToken', result.accessToken.slice(7), {expires: 20 * 60});\r\n            setCookie('refreshToken', result.refreshToken);\r\n            dispatch(success({isAuth: true}));\r\n            dispatch(setUserName({name: result.user.name}));\r\n        } else {\r\n            dispatch(failed());\r\n        }\r\n    }\r\n)\r\n\r\ntype TLoginFormFields = Omit<TRegisterFormFields, 'name'>;\r\n\r\nconst login = createAsyncThunk(\r\n    'user/login',\r\n    async ({password, email}: TLoginFormFields, {dispatch}) => {\r\n        dispatch(request());\r\n        const response = await fetch(`${burgerAPI}/auth/login`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                password,\r\n                email\r\n            })\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            setCookie('accessToken', result.accessToken.slice(7), {expires: 20 * 60});\r\n            setCookie('refreshToken', result.refreshToken);\r\n            dispatch(success({isAuth: true}));\r\n            dispatch(setUserName({name: result.user.name}));\r\n        } else {\r\n            dispatch(failed());\r\n        }\r\n    }\r\n)\r\n\r\nconst logout = createAsyncThunk(\r\n    'user/logout',\r\n    async (_, {dispatch}) => {\r\n        dispatch(request());\r\n        const response = await fetch(`${burgerAPI}/auth/logout`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                token: getCookie('refreshToken')\r\n            })\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            deleteCookie('accessToken');\r\n            deleteCookie('refreshToken');\r\n            dispatch(success({isAuth: false}));\r\n            dispatch(setUserName({name: null}))\r\n        } else {\r\n            dispatch(failed());\r\n        }\r\n    }\r\n)\r\n\r\nconst token = createAsyncThunk(\r\n    'user/token',\r\n    async (_, {dispatch}) => {\r\n        dispatch(request());\r\n        const response = await fetch(`${burgerAPI}/auth/token`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                token: getCookie('refreshToken')\r\n            })\r\n        });\r\n        const result = await response.json();\r\n        const {accessToken, refreshToken} = result;\r\n        if (result.success) {\r\n            setCookie('accessToken', accessToken.slice(7), {expires: 20 * 60});\r\n            setCookie('refreshToken', refreshToken);\r\n            dispatch(success({isAuth: true}))\r\n        } else {\r\n            deleteCookie('accessToken');\r\n            dispatch(success({isAuth: false}));\r\n            dispatch(setUserName({name: null}));\r\n            dispatch(failed());\r\n            console.log('Ошибка при обновлении токена');\r\n        }\r\n    }\r\n)\r\n\r\nconst updateUserName = createAsyncThunk(\r\n    'user/updateUserName',\r\n    async (_, {dispatch}) => {\r\n        const response = await fetch(`${burgerAPI}/auth/user`, {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'authorization': 'Bearer ' + getCookie('accessToken')\r\n            }\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            dispatch(setUserName({name: result.user.name}));\r\n        }\r\n    }\r\n)\r\n\r\nconst getUserData = createAsyncThunk(\r\n    'user/getUserData',\r\n    async (_, {dispatch}) => {\r\n        const response = await fetch(`${burgerAPI}/auth/user`, {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'authorization': 'Bearer ' + getCookie('accessToken')\r\n            }\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            // dispatch(setUserName({userName: result.user.name}));\r\n            dispatch(setUserFormData({\r\n                name: result.user.name,\r\n                email: result.user.email\r\n            }));\r\n            dispatch(setUserName({name: result.user.name}));\r\n            // setFormData({...formData, ...result.user});\r\n        }\r\n    }\r\n)\r\n\r\nconst setUserData = createAsyncThunk(\r\n    'user/setUserData',\r\n    async (formData: TRegisterFormFields, {dispatch}) => {\r\n        const response = await fetch(`${burgerAPI}/auth/user`, {\r\n            method: 'PATCH',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'authorization': 'Bearer ' + getCookie('accessToken')\r\n            },\r\n            body: JSON.stringify({...formData})\r\n        });\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            // dispatch(setUserName({name: result.user.name}));\r\n            dispatch(setUserFormData({\r\n                name: result.user.name,\r\n                email: result.user.email\r\n            }));\r\n            dispatch(setUserName({name: result.user.name}));\r\n            console.log('Данные успешно сохранены');\r\n        } else {\r\n            console.log('Произошла ошибка');\r\n        }\r\n    }\r\n)\r\n\r\nconst userSlice = createSlice({\r\n    name: 'user',\r\n    initialState,\r\n    reducers: {\r\n        request(state) {\r\n            state.isRequest = true;\r\n            state.isFailed = false;\r\n        },\r\n        success(state, {payload: {isAuth}}) {\r\n            state.isRequest = false;\r\n            state.isAuth = isAuth;\r\n        },\r\n        setUserName(state, {payload: {name}}) {\r\n            state.name = name;\r\n        },\r\n        failed(state) {\r\n            state.isRequest = false;\r\n            state.isFailed = true;\r\n        },\r\n        setUserFormData(state, {payload: {name, email}}) {\r\n            state.form.name = name;\r\n            state.form.email = email;\r\n        },// PayloadAction<{[key in TFormKey]: string}>\r\n        updateUserFormData(state, {payload}) {\r\n            for (const key in payload) {\r\n                if (key === 'name' || key === 'email' || key === 'password') {\r\n                    state.form[key] = payload[key];\r\n                } else {\r\n                    console.log(`Поля ${key} не существует в состоянии формы`);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder.addCase(register.rejected, (state, action) => {\r\n            console.log(action.error);\r\n            failed();\r\n        });\r\n        builder.addCase(login.rejected, (state, action) => {\r\n            console.log(action.error);\r\n            failed();\r\n        });\r\n        builder.addCase(logout.rejected, (state, action) => {\r\n            console.log(action.error);\r\n            failed();\r\n        });\r\n        builder.addCase(token.rejected, (state, action) => {\r\n            deleteCookie('accessToken');\r\n            success({isAuth: false});\r\n            setUserName({name: null});\r\n            failed();\r\n            console.log('Ошибка при обновлении токена');\r\n        });\r\n        builder.addCase(updateUserName.rejected, (state, action) => {\r\n            console.log(action.error);\r\n        });\r\n        builder.addCase(getUserData.rejected, (state, action) => {\r\n            console.log(action.error);\r\n        });\r\n        builder.addCase(setUserData.rejected, (state, action) => {\r\n            console.log(action.error);\r\n        });\r\n    }\r\n});\r\n\r\nexport const {request, success, failed, setUserName, setUserFormData, updateUserFormData} = userSlice.actions;\r\n\r\nexport default userSlice.reducer;\r\n\r\ntype TRegisterFormFields = {\r\n    password: string;\r\n    name: string;\r\n    email: string;\r\n}\r\n\r\n\r\n\r\nexport {logout, login, register, token, updateUserName, getUserData, setUserData};","import {createSlice} from '@reduxjs/toolkit';\r\nimport {IOrder} from \"../types\";\r\n\r\nexport type TOrderResponse = {\r\n  success?: boolean;\r\n  orders?: Array<IOrder>;\r\n  total?: number;\r\n  totalToday?: number;\r\n};\r\n\r\nexport type TWSState = {\r\n  orders: TOrderResponse;\r\n  wsConnected: boolean;\r\n}\r\n\r\nconst initialState: TWSState = {\r\n  orders: {},\r\n  wsConnected: false\r\n};\r\n\r\nconst wsSlice = createSlice({\r\n  name: 'ws',\r\n  initialState,\r\n  reducers: {\r\n    wsConnectionStart() {\r\n      // state.wsConnected = true;\r\n    },\r\n    wsConnectionSuccess(state) {\r\n      state.wsConnected = true;\r\n    },\r\n    wsConnectionClosed(state) {\r\n      state.wsConnected = false;\r\n    },\r\n    wsConnectionError(state) {\r\n      state.wsConnected = false;\r\n    },\r\n    wsGetMessage(state, {payload}) {\r\n      state.orders = payload;\r\n    }\r\n  },\r\n});\r\nexport const {\r\n  wsConnectionStart,\r\n  wsConnectionSuccess,\r\n  wsConnectionClosed,\r\n  wsConnectionError,\r\n  wsGetMessage\r\n} = wsSlice.actions;\r\n\r\nexport default wsSlice.reducer;\r\n","import {createSlice} from '@reduxjs/toolkit';\r\nimport {IOrder} from \"../types\";\r\n\r\nexport type TUserWSState = {\r\n  orders: Array<IOrder>;\r\n  wsConnected: boolean;\r\n}\r\nconst initialState: TUserWSState = {\r\n  orders: [],\r\n  wsConnected: false\r\n};\r\n\r\nconst wsUserSlice = createSlice({\r\n  name: 'wsUser',\r\n  initialState,\r\n  reducers: {\r\n    wsUserConnectionStart() {\r\n      // state.wsConnected = true;\r\n    },\r\n    wsUserConnectionSuccess(state) {\r\n      state.wsConnected = true;\r\n    },\r\n    wsUserConnectionClosed(state) {\r\n      state.wsConnected = false;\r\n    },\r\n    wsUserConnectionError(state) {\r\n      state.wsConnected = false;\r\n    },\r\n    wsUserGetMessage(state, {payload}) {\r\n      state.orders = payload.orders;\r\n    }\r\n  },\r\n});\r\nexport const {\r\n  wsUserConnectionStart,\r\n  wsUserConnectionSuccess,\r\n  wsUserConnectionClosed,\r\n  wsUserConnectionError,\r\n  wsUserGetMessage\r\n} = wsUserSlice.actions;\r\n\r\nexport default wsUserSlice.reducer;\r\n","import {createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\nimport burgerConstructorReducer, {reset} from './burgerConstructor';\r\nimport burgerIngredientsReducer from './burgerIngredients';\r\nimport userSlice from './user';\r\nimport {getCookie} from \"../utils\";\r\nimport wsReducer from './ws';\r\nimport wsUserReducer from './wsUser';\r\n\r\nexport interface IOrderState {\r\n  orderNumber: number | null;\r\n  orderRequest: boolean;\r\n  orderFailed: boolean;\r\n}\r\n\r\nconst initialState:IOrderState = {\r\n  orderNumber: null,\r\n  orderRequest: false,\r\n  orderFailed: false\r\n};\r\n\r\nconst order = createAsyncThunk(\r\n    'order/createOrder',\r\n    async (params: { orderURL: string, ingredients: { ingredients: Array<string> } }, {dispatch}) => {\r\n      dispatch(orderRequest());\r\n      const {orderURL, ingredients} = params;\r\n      const response = await fetch(orderURL, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json;charset=utf-8',\r\n          'authorization': 'Bearer ' + getCookie('accessToken')\r\n        },\r\n        body: JSON.stringify(ingredients)\r\n      });\r\n      const result = await response.json();\r\n      if (result.success) {\r\n        dispatch(orderSuccess({\r\n          orderNumber: result.order.number\r\n        }));\r\n        dispatch(reset());\r\n      } else {\r\n        dispatch(orderFailed());\r\n      }\r\n    }\r\n)\r\n\r\nconst orderSlice = createSlice({\r\n  name: 'order',\r\n  initialState,\r\n  reducers: {\r\n    orderClose(state) {\r\n      state.orderNumber = null;\r\n    },\r\n    orderRequest(state) {\r\n      state.orderRequest = true;\r\n      state.orderFailed = false;\r\n    },\r\n    orderSuccess(state, {payload}: PayloadAction<{orderNumber: number}>) {\r\n      state.orderRequest = false;\r\n      state.orderNumber = payload.orderNumber;\r\n    },\r\n    orderFailed(state) {\r\n      state.orderRequest = false;\r\n      state.orderFailed = true;\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase(order.rejected, (state, action) => {\r\n      console.log(action.error);\r\n      orderFailed();\r\n    });\r\n  }\r\n});\r\n\r\nexport const {orderClose, orderRequest, orderSuccess, orderFailed} = orderSlice.actions;\r\n\r\nexport {order};\r\nconst orderReducer = orderSlice.reducer;\r\nexport {orderReducer};\r\n\r\nconst rootReducer = {\r\n  order: orderReducer,\r\n  ingredients: burgerConstructorReducer,\r\n  data: burgerIngredientsReducer,\r\n  user: userSlice,\r\n  orders: wsReducer,\r\n  ordersUser: wsUserReducer\r\n};\r\n\r\nexport default rootReducer;\r\n","import React, {FC} from 'react';\r\nimport {useAppSelector} from \"../../services/hooks\";\r\nimport {Link, NavLink} from 'react-router-dom';\r\nimport {Logo, BurgerIcon, ListIcon, ProfileIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport appHeaderStyles from './AppHeader.module.css';\r\n\r\nconst AppHeader: FC = () => {\r\n  const {isAuth, name} = useAppSelector(({user}) => user);\r\n\r\n  const loginPath = isAuth ? 'profile' : 'login';\r\n\r\n  return (\r\n    <header className={`${appHeaderStyles.header} mb-10`}>\r\n      <nav className={appHeaderStyles['nav-header']}>\r\n        <ul className={appHeaderStyles['nav-list']}>\r\n          <li className={`pt-4 pr-5 pb-4 pl-5`}>\r\n            <NavLink to=\"/\" exact={true} className={`${appHeaderStyles['nav-item']}`}\r\n                     activeClassName={`${appHeaderStyles['nav-item-active']}`}>\r\n              <BurgerIcon type=\"secondary\"/>\r\n              <span className={`pl-2 text text_type_main-default text_color_inactive`}>Конструктор</span>\r\n            </NavLink>\r\n          </li>\r\n          <li className={`${appHeaderStyles['nav-item']} pt-4 pr-5 pb-4 pl-5`}>\r\n            <NavLink to=\"/feed\" exact={true} className={`${appHeaderStyles['nav-item']}`}\r\n                     activeClassName={`${appHeaderStyles['nav-item-active']}`}>\r\n              <ListIcon type=\"secondary\"/>\r\n              <span className={`pl-2 text text_type_main-default text_color_inactive`}>Лента заказов</span>\r\n            </NavLink>\r\n          </li>\r\n        </ul>\r\n      </nav>\r\n      <Link to={\"/\"}>\r\n        <Logo/>\r\n      </Link>\r\n      <div className={`pt-4 pr-5 pb-4 pl-5`}>\r\n        <NavLink to={`/${loginPath}`} exact={true} className={`${appHeaderStyles['header-personal-area']}`}\r\n                 activeClassName={`${appHeaderStyles['nav-item-active']}`}>\r\n          <ProfileIcon type=\"secondary\"/>\r\n          <span\r\n            className={`pl-2 text text_type_main-default text_color_inactive`}>{name ? name : 'Личный кабинет'}</span>\r\n        </NavLink>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n\r\nexport default AppHeader;\r\n","import React, {FC} from 'react';\r\n\r\nimport modalOverlayStyles from './ModalOverlay.module.css';\r\n\r\ntype TModalOverlay = {\r\n  onClick: React.MouseEventHandler\r\n};\r\n\r\nconst ModalOverlay:FC<TModalOverlay> = (props) => {\r\n  return (\r\n    <div className={modalOverlayStyles.overlay} onClick={props.onClick}>\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ModalOverlay;","import React, {FC, MouseEvent} from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {CloseIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport ModalOverlay from '../ModalOverlay/ModalOverlay';\r\nimport modalStyles from './Modal.module.css';\r\n\r\nconst modalRoot = document.getElementById('react-modals') as Element;\r\n\r\ntype TModal = {\r\n  title: string;\r\n  onClose: () => void;\r\n};\r\n\r\nconst Modal:FC<TModal> = (props) => {\r\n  const {title, onClose, children} = props;\r\n  const handlerCloseButton = React.useCallback((e) => {\r\n    if (e.key === 'Escape') {\r\n      onClose();\r\n    }\r\n  }, [onClose]);\r\n\r\n  React.useEffect(() => {\r\n    document.addEventListener('keydown', handlerCloseButton);\r\n    return () => {\r\n      document.removeEventListener('keydown', handlerCloseButton);\r\n    };\r\n  }, [handlerCloseButton]);\r\n\r\n  const handlerClose = (e:MouseEvent) => {\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  }\r\n\r\n  return ReactDOM.createPortal((\r\n      <ModalOverlay onClick={handlerClose}>\r\n        <div className={`${modalStyles['inner']} pt-10 pr-10 pb-15 pl-10`}>\r\n          <div className={`${modalStyles.header}`}>\r\n            <h2 className={`text text_type_main-large mr-9`}>\r\n              {title}\r\n            </h2>\r\n            <CloseIcon type=\"primary\" onClick={onClose}/>\r\n          </div>\r\n          {children}\r\n        </div>\r\n      </ModalOverlay>\r\n    ),\r\n    modalRoot\r\n  );\r\n}\r\n\r\nexport default Modal;\r\n","export default __webpack_public_path__ + \"static/media/done.cd07b5c6.png\";","import {FC} from 'react';\r\n\r\nimport orderDetailsStyles from './OrderDetails.module.css';\r\nimport doneImg from '../../images/done.png';\r\n\r\ntype TOrderDetails = {\r\n    orderNumber: number | null\r\n};\r\n\r\nconst OrderDetails:FC<TOrderDetails> = (props) => {\r\n  return (\r\n    <div className={`${orderDetailsStyles.container} mb-15`}>\r\n      <span className={`${orderDetailsStyles.number} mt-4 mb-8 text text_type_digits-large`}>{props.orderNumber}</span>\r\n      <span className=\"mb-15 text text_type_main-medium\">идентификатор заказа</span>\r\n      <img src={doneImg} alt={'done'} className=\"mb-15\" />\r\n      <span\r\n        className={`${orderDetailsStyles['small-text']} mb-2 text text_type_main-small`}>Ваш заказ начали готовить</span>\r\n      <span className={`${orderDetailsStyles['small-text']} mb-2 text text_type_main-small text_color_inactive`}>Дождитесь готовности на орбитальной станции</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default OrderDetails;\r\n","import React, {FC} from \"react\";\r\nimport {useParams} from 'react-router-dom';\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport ingredientDetailsStyles from './IngredientDetails.module.css';\r\nimport {getData} from \"../../services/slices/burgerIngredients\";\r\n\r\nimport {IIngredient} from \"../../services/types\";\r\nimport {burgerAPI} from \"../../services/utils\";\r\n\r\nconst dataURL = `${burgerAPI}/ingredients`;\r\n\r\ntype TIngredientDetails = {\r\n  className?: string;\r\n  title?: string;\r\n};\r\n\r\nconst IngredientDetails:FC<TIngredientDetails> = ({ className, title }) => {\r\n  const dispatch = useAppDispatch();\r\n  const {data} = useAppSelector(({data}) => data);\r\n  const {ingredientId} = useParams<{ ingredientId: string}>();\r\n\r\n  if (data.length === 0) {\r\n    dispatch(getData(dataURL));\r\n  }\r\n\r\n  const ingredient = data.find((item: IIngredient) => item._id === ingredientId);\r\n\r\n  return (\r\n    <div className={`${ingredientDetailsStyles.container} ${className}`}>\r\n      {title && (<h2 className={`text text_type_main-large mr-9`}>\r\n        {title}\r\n      </h2>)}\r\n      {ingredient ? (\r\n          <>\r\n            <img alt={ingredient.name} src={ingredient.image_large} className='mb-4'/>\r\n            <div className={ingredientDetailsStyles.description}>\r\n              <h3 className={`${ingredientDetailsStyles.name} text text_type_main-medium mb-8`}>{ingredient.name}</h3>\r\n              <ul className={`${ingredientDetailsStyles['info-list']} text_color_inactive`}>\r\n                <li className={`${ingredientDetailsStyles['info-list-item']}`}>\r\n                  <span className={`${ingredientDetailsStyles['nutrition-type-name']} text text_type_main-small`}>Калории, ккал</span>\r\n                  <span className=\"text text_type_digits-default\">{ingredient.calories}</span>\r\n                </li>\r\n                <li className={ingredientDetailsStyles['info-list-item']}>\r\n                <span\r\n                  className={`${ingredientDetailsStyles['nutrition-type-name']} text text_type_main-small`}>Белки, г</span>\r\n                  <span className=\"text text_type_digits-default\">{ingredient.proteins}</span>\r\n                </li>\r\n                <li className={ingredientDetailsStyles['info-list-item']}>\r\n                <span\r\n                  className={`${ingredientDetailsStyles['nutrition-type-name']} text text_type_main-small`}>Жиры, г</span>\r\n                  <span className=\"text text_type_digits-default\">{ingredient.fat}</span>\r\n                </li>\r\n                <li className={ingredientDetailsStyles['info-list-item']}>\r\n                <span\r\n                  className={`${ingredientDetailsStyles['nutrition-type-name']} text text_type_main-small`}>Углеводы, г</span>\r\n                  <span className=\"text text_type_digits-default\">{ingredient.carbohydrates}</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </>\r\n        ) : (\r\n        <span className=\"text text_type_main-medium mt-10\">Загружаем данные... </span>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default IngredientDetails;\r\n","import React, {useEffect, useState, FC} from 'react';\r\nimport {Route, Redirect} from 'react-router-dom';\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\n\r\nimport {getCookie} from \"../../services/utils\";\r\nimport {token, request, success} from \"../../services/slices/user\";\r\nimport styles from \"../App/App.module.css\";\r\nimport Loader from \"react-loader-spinner\";\r\n\r\ntype TProtectedRoute = {\r\n  path: string;\r\n};\r\n\r\nconst ProtectedRoute: FC<TProtectedRoute> = ({children, path}) => {\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const hasAccessToken = getCookie('accessToken');\r\n  const hasRefreshToken = getCookie('refreshToken');\r\n  const dispatch = useAppDispatch();\r\n  const {isRequest} = useAppSelector(({user}) => user);\r\n  useEffect(() => {\r\n    dispatch(request());\r\n    if (hasRefreshToken) {\r\n      dispatch(token());\r\n    } else {\r\n      dispatch(success({isAuth: false}));\r\n    }\r\n  }, []); // eslint-disable-line\r\n\r\n  useEffect(() => {\r\n    if (isRequest === false) {\r\n      setIsLoading(isRequest);\r\n    }\r\n  }, [isRequest]);\r\n\r\n  if (isLoading || isRequest) {\r\n    return (\r\n      <div className={styles.loader_no_offset_top}>\r\n        <Loader\r\n          type=\"Oval\"\r\n          color=\"#9C64D9\"\r\n          height={100}\r\n          width={100}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      path={path}\r\n      render={({location}) => hasAccessToken && hasRefreshToken ? (\r\n        children\r\n      ) : (\r\n        <Redirect to={{\r\n          pathname: \"/login\",\r\n          state: {\r\n            from: location\r\n          }\r\n        }}/>\r\n      )}\r\n    />\r\n  );\r\n}\r\n\r\nexport default ProtectedRoute;\r\n","import React, {FC} from 'react';\r\nimport {useDrag} from 'react-dnd';\r\nimport {CurrencyIcon, Counter} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport burgerIngredientStyles from './BurgerIngredient.module.css';\r\n\r\nimport {IIngredient} from \"../../services/types\";\r\n\r\ninterface IIngredientItem {\r\n  ingredient: IIngredient;\r\n  cnt: number\r\n}\r\n\r\nconst BurgerIngredient:FC<IIngredientItem> = ({ingredient, cnt}) => {\r\n  const {image_large, name, price} = ingredient;\r\n\r\n  const [, dragRef] = useDrag({\r\n    type: 'ingredient',\r\n    item: {ingredient}\r\n  });\r\n\r\n  return (\r\n    <div className={burgerIngredientStyles[\"burger-ingredient\"]} ref={dragRef}>\r\n      {cnt ? <div className={burgerIngredientStyles[\"burger-ingredient-cnt\"]}><Counter count={cnt} size=\"default\"/></div> : null}\r\n      <img src={image_large} alt={name} className={`${burgerIngredientStyles[\"burger-ingredient-img\"]} pr-4 pl-4`}/>\r\n      <div className={burgerIngredientStyles[\"burger-ingredient-price\"]}>\r\n        <span className={\"text text_type_digits-default\"}>{price}</span>\r\n        <CurrencyIcon type=\"primary\"/>\r\n      </div>\r\n      <span className={`${burgerIngredientStyles[\"burger-ingredient-name\"]} text text_type_main-default`}>{name}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default React.memo(BurgerIngredient);\r\n","import React, {FC} from 'react';\r\nimport {useLocation, Link} from \"react-router-dom\";\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {Tab} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {updateCurrentTab} from '../../services/slices/burgerIngredients';\r\nimport BurgerIngredient from './BurgerIngredient';\r\nimport burgerIngredientsStyles from './BurgerIngredients.module.css';\r\n\r\nimport {IIngredient} from \"../../services/types\";\r\n\r\nconst  BurgerIngredients:FC = () => {\r\n    const dispatch = useAppDispatch();\r\n    const location = useLocation();\r\n    const {data, currentTab} = useAppSelector(({data}) => data);\r\n    const {qty} = useAppSelector(({ingredients}) => ingredients);\r\n\r\n    const setTab = (tab: string) => {\r\n        const ulIngredients: HTMLElement | null = document.getElementById('ingredients_list');\r\n        const ingredientsBlock: HTMLElement | null = document.getElementById(`${tab}_list`);\r\n        if (ulIngredients && ingredientsBlock) {\r\n            ulIngredients.scrollTo(0, ingredientsBlock.offsetTop - ulIngredients.offsetTop);\r\n        }\r\n    }\r\n\r\n    const handleScroll = (e: React.SyntheticEvent): void => {\r\n        const ulIngredients = e.target as HTMLElement;\r\n        const parentTop = ulIngredients.getBoundingClientRect().y;\r\n        const saucesTop = ulIngredients.querySelector('#sauces_list')?.getBoundingClientRect().y;\r\n        const mainsTop = ulIngredients.querySelector('#mains_list')?.getBoundingClientRect().y;\r\n        if (mainsTop && saucesTop) {\r\n            if (mainsTop - parentTop <= 0) {\r\n                dispatch(updateCurrentTab({tab: 'mains'}))\r\n            } else if (saucesTop - parentTop <= 0) {\r\n                dispatch(updateCurrentTab({tab: 'sauces'}))\r\n            } else {\r\n                dispatch(updateCurrentTab({tab: 'buns'}))\r\n            }\r\n        }\r\n    }\r\n\r\n    type TSortedData = {\r\n        title: string;\r\n        data: Array<IIngredient>;\r\n        type: string;\r\n    };\r\n\r\n    const sortedData: Array<TSortedData> = [{\r\n        title: 'Булки',\r\n        data: [],\r\n        type: 'buns'\r\n    }, {\r\n        title: 'Соусы',\r\n        data: [],\r\n        type: 'sauces'\r\n    }, {\r\n        title: 'Начинки',\r\n        data: [],\r\n        type: 'mains'\r\n    }];\r\n\r\n    const typeIngredient = {\r\n        buns: 0,\r\n        sauces: 1,\r\n        mains: 2\r\n    };\r\n\r\n    data.forEach((item: IIngredient) => {\r\n        if (item.type === 'bun') {\r\n            sortedData[typeIngredient.buns].data.push(item);\r\n        } else if (item.type === 'sauce') {\r\n            sortedData[typeIngredient.sauces].data.push(item);\r\n        } else {\r\n            sortedData[typeIngredient.mains].data.push(item);\r\n        }\r\n    });\r\n\r\n    const getIngredientCount = (ingredient: IIngredient) => {\r\n        return qty[ingredient._id] ? qty[ingredient._id] : 0;\r\n    }\r\n\r\n    return (\r\n        <div className={burgerIngredientsStyles[\"burger-ingredients\"]}>\r\n            <div className={`${burgerIngredientsStyles[\"burger-ingredients-tab\"]} mb-10`}>\r\n                <Tab value=\"buns\" active={currentTab === 'buns'} onClick={setTab}>\r\n                    Булки\r\n                </Tab>\r\n                <Tab value=\"sauces\" active={currentTab === 'sauces'} onClick={setTab}>\r\n                    Соусы\r\n                </Tab>\r\n                <Tab value=\"mains\" active={currentTab === 'mains'} onClick={setTab}>\r\n                    Начинки\r\n                </Tab>\r\n            </div>\r\n            <ul className={burgerIngredientsStyles[\"burger-ingredients-type-list\"]} onScroll={handleScroll}\r\n                id=\"ingredients_list\">\r\n                {sortedData.map(type => (\r\n                    <li className={burgerIngredientsStyles[\"burger-ingredients-type-item\"]} key={type.title}\r\n                        id={`${type.type}_list`}>\r\n                        <h2 className={\"text text_type_main-medium\"}>{type.title}</h2>\r\n                        <ul className={`${burgerIngredientsStyles[\"burger-ingredients-list\"]} pl-4 pr-4`}>\r\n                            {type.data.map(item => (\r\n                                <li className={`${burgerIngredientsStyles[\"burger-ingredients-item\"]} mb-2`}\r\n                                    key={item._id}>\r\n                                    <Link to={{\r\n                                        pathname: `/ingredients/${item._id}`,\r\n                                        state: {background: location}\r\n                                    }}>\r\n                                        <BurgerIngredient ingredient={item} cnt={getIngredientCount(item)}/>\r\n                                    </Link>\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BurgerIngredients;\r\n","import {useRef, FC} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useDrag, useDrop} from 'react-dnd';\r\nimport {useHistory, useLocation} from 'react-router-dom';\r\nimport {ConstructorElement, DragIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {removeIngredient} from '../../services/slices/burgerConstructor';\r\nimport burgerConstructorItemStyles from './BurgerConstructorItem.module.css';\r\nimport {IIngredient} from \"../../services/types\";\r\n\r\ninterface IConstructorItem {\r\n  ingredient: IIngredient,\r\n  index: number,\r\n  moveComponent: (dragIndex: number, hoverIndex: number) => void\r\n}\r\n\r\nexport const BurgerConstructorItem:FC<IConstructorItem> = (props) => {\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const {ingredient, index, moveComponent} = props;\r\n  const {name, price, image} = ingredient;\r\n\r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  const [, drop] = useDrop({\r\n    accept: 'ingredientMove',\r\n    hover(item:{index: number}, monitor) {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      const dragIndex = item.index;\r\n      const hoverIndex = index;\r\n      // Don't replace items with themselves\r\n      if (dragIndex === hoverIndex) {\r\n        return;\r\n      }\r\n      // Determine rectangle on screen\r\n      const hoverBoundingRect = ref.current?.getBoundingClientRect();\r\n      // Get vertical middle\r\n      const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\r\n      // Determine mouse position\r\n      const clientOffset = monitor.getClientOffset();\r\n      // Get pixels to the top\r\n      const hoverClientY = clientOffset === null ? 0 : clientOffset.y - hoverBoundingRect.top;\r\n      // Only perform the move when the mouse has crossed half of the items height\r\n      // When dragging downwards, only move when the cursor is below 50%\r\n      // When dragging upwards, only move when the cursor is above 50%\r\n      // Dragging downwards\r\n      if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\r\n        return;\r\n      }\r\n      // Dragging upwards\r\n      if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\r\n        return;\r\n      }\r\n      // Time to actually perform the action\r\n      moveComponent(dragIndex, hoverIndex);\r\n      // Note: we're mutating the monitor item here!\r\n      // Generally it's better to avoid mutations,\r\n      // but it's good here for the sake of performance\r\n      // to avoid expensive index searches.\r\n      item.index = hoverIndex;\r\n    },\r\n  });\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const handleOpenModal = (ingredientId:string) => {\r\n    return () => {\r\n      history.push({\r\n        pathname: `/ingredients/${ingredientId}`,\r\n        state: {background: location}\r\n      });\r\n    }\r\n  };\r\n  const handleRemoveIngredient = (index:number) => {\r\n    return () => {\r\n      dispatch(removeIngredient({index}));\r\n    };\r\n  }\r\n\r\n  const [, drag] = useDrag({\r\n    type: 'ingredientMove',\r\n    item: () => {\r\n      return {index};\r\n    },\r\n  });\r\n  drag(drop(ref));\r\n\r\n  return (\r\n    <div className={burgerConstructorItemStyles[\"burger-constructor-list-item\"]} ref={ref}>\r\n      <DragIcon type=\"primary\"/>\r\n      <div className={burgerConstructorItemStyles[\"burger-constructor-list-item-inner\"]}\r\n           onClick={handleOpenModal(ingredient._id)}>\r\n        <ConstructorElement\r\n          text={name}\r\n          price={price}\r\n          thumbnail={image}\r\n          handleClose={handleRemoveIngredient(index)}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, {FC, useCallback} from 'react';\r\nimport {Link, useHistory, useLocation} from \"react-router-dom\";\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {ConstructorElement, CurrencyIcon, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {order} from '../../services/slices';\r\nimport {updateComponentsSort} from '../../services/slices/burgerConstructor';\r\nimport {BurgerConstructorItem} from './BurgerConstructorItem';\r\n\r\nimport burgerConstructorStyles from './BurgerConstructor.module.css';\r\n\r\nimport {IIngredient} from '../../services/types';\r\nimport {burgerAPI} from \"../../services/utils\";\r\n\r\nexport interface IIngredientComponent {\r\n  ingredient: IIngredient,\r\n  id: number\r\n}\r\n\r\nconst orderURL = `${burgerAPI}/orders`;\r\n\r\nconst BurgerConstructor:FC = () => {\r\n  const dispatch = useAppDispatch();\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const {bun, components} = useAppSelector(({ingredients}) => ingredients);\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n\r\n  const total = (components.length ? components.reduce((sum: number, {ingredient} : IIngredientComponent) => sum + ingredient.price, 0) : 0) + (bun ? bun.price * 2 : 0);\r\n\r\n  const handleOpenOrderModal = async () => {\r\n    if (!isAuth) {\r\n      history.push('/login');\r\n      return;\r\n    }\r\n    if (bun === null) {\r\n      console.log('Заказать можно только с выбранной булкой');\r\n      return;\r\n    }\r\n    const ingredients = {\r\n      ingredients: [bun._id]\r\n    };\r\n\r\n    components.forEach((ingredient: IIngredientComponent) => {\r\n      ingredients.ingredients.push(ingredient.ingredient._id);\r\n    });\r\n\r\n    // Добавляем вторую булку в конец нашего бургера\r\n    ingredients.ingredients.push(bun._id);\r\n\r\n    dispatch(order({orderURL, ingredients}));\r\n  }\r\n\r\n  const moveComponent = useCallback((dragIndex, hoverIndex) => {\r\n    dispatch(updateComponentsSort({\r\n      fromIndex: dragIndex,\r\n      toIndex: hoverIndex\r\n    }));\r\n  }, [dispatch]);\r\n\r\n  return (\r\n    <div className={`${burgerConstructorStyles[\"burger-constructor\"]} pl-4 pb-15`}>\r\n      {bun && (\r\n        <Link to={{\r\n          pathname: `/ingredients/${bun._id}`,\r\n          state: {background: location}\r\n        }}>\r\n          <div className=\"pl-8\">\r\n            <ConstructorElement\r\n              text={`${bun.name} (верх)`}\r\n              price={bun.price}\r\n              thumbnail={bun.image}\r\n              isLocked={true}\r\n              type={'top'}\r\n            />\r\n          </div>\r\n        </Link>\r\n      )}\r\n      <ul className={`${burgerConstructorStyles[\"burger-constructor-list\"]} pr-2`}>\r\n        {components.map((item: IIngredientComponent, index: number) => (\r\n          <li key={item.id}>\r\n            <BurgerConstructorItem ingredient={item.ingredient} index={index} moveComponent={moveComponent}/>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      {bun && (<div className=\"pl-8 mb-10\">\r\n          <Link to={{\r\n            pathname: `/ingredients/${bun._id}`,\r\n            state: {background: location}\r\n          }}>\r\n            <ConstructorElement\r\n              text={`${bun.name} (низ)`}\r\n              price={bun.price}\r\n              thumbnail={bun.image}\r\n              isLocked={true}\r\n              type={'bottom'}\r\n            />\r\n          </Link>\r\n        </div>\r\n      )}\r\n      <div className={`${burgerConstructorStyles[\"burger-constructor-summary-and-offer-btn\"]} pr-4`}>\r\n        <div className={`${burgerConstructorStyles['burger-constructor-summary']} mr-10`}>\r\n          <p className=\"text text_type_digits-medium mr-2\">{total}</p>\r\n          <CurrencyIcon type=\"primary\"/>\r\n        </div>\r\n        {bun && (<Button type=\"primary\" size=\"large\" onClick={handleOpenOrderModal}>\r\n            Оформить\r\n          </Button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BurgerConstructor;\r\n","import React, {FC} from 'react';\r\nimport {useDrop} from \"react-dnd\";\r\nimport {useAppDispatch, useAppSelector} from \"../services/hooks\";\r\nimport BurgerIngredients from \"../components/BurgerIngredients/BurgerIngredients\";\r\nimport BurgerConstructor from \"../components/BurgerConstructor/BurgerConstructor\";\r\nimport {getData} from \"../services/slices/burgerIngredients\";\r\nimport {addIngredient} from \"../services/slices/burgerConstructor\";\r\nimport styles from \"./home.module.css\";\r\nimport {burgerAPI} from \"../services/utils\";\r\n\r\nconst dataURL = `${burgerAPI}/ingredients`;\r\n\r\nexport {dataURL};\r\n\r\nconst HomePage:FC = () => {\r\n  const dispatch = useAppDispatch();\r\n  const {data, dataRequest, dataFailed} = useAppSelector(({data}) => data);\r\n\r\n  React.useEffect(() => {\r\n    if (data.length === 0) {\r\n      dispatch(getData(dataURL));\r\n    }\r\n  }, [dispatch, data.length]);\r\n\r\n  const [, dropTarget] = useDrop({\r\n    accept: 'ingredient',\r\n    drop(ingredient) {\r\n      dispatch(addIngredient(ingredient))\r\n    }\r\n  });\r\n\r\n  return (\r\n    <section className={`${styles[\"section-make-burger\"]} mb-10`}>\r\n      {dataRequest ? <span className=\"text text_type_main-medium\">Загружаем компоненты...</span>\r\n        : dataFailed ? <span className=\"text text_type_main-medium\">Произошла ошибка при загрузке :( </span>\r\n          : data.length ? <>\r\n            <h1 className=\"text text_type_main-large mb-5\">\r\n              Собери бургер\r\n            </h1>\r\n            <ul className={styles[\"section-make-burger-list\"]}>\r\n              <li className={`${styles[\"section-make-burger-item\"]} mr-10`}>\r\n                <BurgerIngredients/>\r\n              </li>\r\n              <li className={styles[\"section-make-burger-item\"]} ref={dropTarget}>\r\n                <BurgerConstructor/>\r\n              </li>\r\n            </ul>\r\n          </> : <span className=\"text text_type_main-medium\">Сегодня ничего нет в меню :(</span>}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport {HomePage};","import React, {FC} from 'react';\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {useLocation, useParams, matchPath} from \"react-router-dom\";\r\nimport {CurrencyIcon} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\n\r\nimport styles from './OrderInfo.module.css';\r\nimport {getData} from \"../../services/slices/burgerIngredients\";\r\nimport {dataURL} from \"../../pages/home\";\r\nimport {wsConnectionStart} from '../../services/slices/ws';\r\nimport {wsUserConnectionStart} from '../../services/slices/wsUser';\r\nimport {humanReadableDate} from \"../../services/utils\";\r\n\r\nimport {IOrder} from \"../../services/types\";\r\nimport {IIngredient} from \"../../services/types\";\r\n\r\nconst OrderInfo: FC<{ className?: string }> = () => {\r\n    const location = useLocation();\r\n    let {orderId} = useParams<{ orderId: string }>();\r\n    const ordersCommon = useAppSelector(({orders}) => orders);\r\n    const orderUser = useAppSelector(({ordersUser}) => ordersUser);\r\n    const dispatch = useAppDispatch();\r\n    const {data} = useAppSelector(({data}) => data);\r\n\r\n    if (!orderId) { //При переходе из Личного кабинета useParams не работает. Пришлось задействовать matchPath\r\n        const match: { params: { orderId: string } } | null = matchPath(location.pathname, {\r\n            path: '/profile/orders/:orderId',\r\n            exact: true,\r\n            strict: false\r\n        });\r\n        if (match) {\r\n            orderId = match.params.orderId;\r\n        }\r\n    }\r\n\r\n    const orders = location.pathname.indexOf('profile') >= 0 ? orderUser.orders : ordersCommon.orders.orders;\r\n\r\n    React.useEffect(() => {\r\n        if (data.length === 0) {\r\n            dispatch(getData(dataURL));\r\n        }\r\n        if (!orders || orders.length === 0) {\r\n            if (location.pathname.indexOf('profile') >= 0) {\r\n                dispatch(wsUserConnectionStart());\r\n            } else {\r\n                dispatch(wsConnectionStart());\r\n            }\r\n        }\r\n    }, [dispatch, data.length, orders, location.pathname]);\r\n\r\n    if ((!orders || orders.length === 0) || !data) {\r\n        return (\r\n            <div className={styles.wrapper}>\r\n                <span className={'text text_type_main-large'}>\r\n                  Загрузка...\r\n                </span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const order = orders.find((order: IOrder) => order._id === orderId);\r\n\r\n    type TCompositionIngredient = {\r\n        qty: number;\r\n        name?: string;\r\n        img?: string;\r\n        price?: number;\r\n    };\r\n    type TComposition = {\r\n        [key: string]: TCompositionIngredient\r\n    };\r\n    const composition: TComposition = {};\r\n    if (!order) {\r\n        return (\r\n            <div className={styles.wrapper}>\r\n                <span className={'text text_type_main-large'}>\r\n                  Заказ не найден\r\n                </span>\r\n            </div>\r\n        );\r\n    }\r\n    order.ingredients.forEach((ingredient: string) => {\r\n        if (composition[ingredient]) {\r\n            composition[ingredient].qty += 1;\r\n        } else {\r\n            composition[ingredient] = {qty: 1};\r\n        }\r\n    });\r\n    let total = 0;\r\n    for (const ingredient in composition) {\r\n        const found = data.find((item: IIngredient) => item._id === ingredient);\r\n        if (found) {\r\n            const {name, image_mobile, price} = found;\r\n            composition[ingredient].name = name;\r\n            composition[ingredient].img = image_mobile;\r\n            composition[ingredient].price = price;\r\n            total += price * composition[ingredient].qty;\r\n        }\r\n    }\r\n\r\n    const printComposition = (composition: TComposition) => {\r\n        const arr = [];\r\n        for (const ingredient in composition) {\r\n            arr.push((\r\n                <li key={ingredient} className={styles.ingredient_info}>\r\n                    <div className={styles.ingredient_icon_name}>\r\n                        <img\r\n                            className={`${styles.ingredient_icon} mr-4`}\r\n                            src={composition[ingredient].img}\r\n                            alt=\"\"\r\n                        />\r\n                        <span className={`text text_type_main-default`}>{composition[ingredient].name}</span>\r\n                    </div>\r\n                    <div className={styles.ingredient_qty_price}>\r\n                        <span className={'text text_type_digits-default'}>{composition[ingredient].qty}</span>\r\n                        <span className={'text text_type_main-default mr-2 ml-2'}>x</span>\r\n                        <span className={'text text_type_digits-default mr-2'}>{composition[ingredient].price}</span>\r\n                        <CurrencyIcon type=\"primary\"/>\r\n                    </div>\r\n                </li>\r\n            ))\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    const statusText = (status: string) => {\r\n        const style: { color?: string } = {};\r\n        let text = ''\r\n        switch (status) {\r\n            case 'created':\r\n                text = 'Создан';\r\n                break;\r\n            case 'pending':\r\n                text = 'Готовится';\r\n                break;\r\n            case 'done':\r\n                text = 'Выполнен';\r\n                style.color = '#00CCCC';\r\n                break;\r\n            default:\r\n        }\r\n        return (\r\n            <p className=\"text text_type_main-default mb-15\" style={style}>{text}</p>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={styles.wrapper}>\r\n            <p className={`text text_type_digits-default mb-10 ${styles.align_center}`}>#{order.number}</p>\r\n            <p className={'text text_type_main-medium mb-3'}>{order.name}</p>\r\n            {statusText(order.status)}\r\n            <p className={'text text_type_main-medium mb-6'}>Состав:</p>\r\n            <ul className={`${styles.composition} mb-10 pr-6`}>\r\n                {printComposition(composition)}\r\n            </ul>\r\n            <div className={styles.time_total}>\r\n        <span\r\n            className=\"text text_type_main-default text_color_inactive\">{humanReadableDate(new Date(order.createdAt))}</span>\r\n                <div className={styles.total}><span\r\n                    className={'text text_type_digits-default mr-2'}>{total}</span><CurrencyIcon\r\n                    type=\"primary\"/></div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default OrderInfo;","import React, {ChangeEventHandler, FC, FormEventHandler, useState} from 'react';\r\nimport {Link, Redirect, useLocation} from 'react-router-dom';\r\nimport {useAppDispatch, useAppSelector} from \"../services/hooks\";\r\nimport {EmailInput, PasswordInput, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './login.module.css';\r\nimport {login} from \"../services/slices/user\";\r\n\r\nimport {ILocation} from \"../services/types\";\r\n\r\ninterface ILoginForm {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nconst LoginPage:FC = () => {\r\n  const [formData, setFormData] = useState<ILoginForm>({\r\n    email: '',\r\n    password: ''\r\n  });\r\n  const dispatch = useAppDispatch();\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n  const {state} = useLocation<ILocation>();\r\n\r\n  const onChangeField: ChangeEventHandler = (e) => {\r\n    const element = e.target as HTMLInputElement;\r\n    setFormData({\r\n      ...formData,\r\n      [element.name]: element.value\r\n    });\r\n  }\r\n\r\n  if (isAuth) {\r\n    return (\r\n      <Redirect to={(state && state.from) || \"/\"}/>\r\n    );\r\n  }\r\n\r\n  const onSubmitForm:FormEventHandler = (e) => {\r\n    e.preventDefault();\r\n    dispatch(login({...formData}))\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.container} mt-15`}>\r\n      <form onSubmit={onSubmitForm}>\r\n        <h2 className={`text text_type_main-medium mt-30 mb-6`}>Вход</h2>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <EmailInput name={'email'} size={'default'} value={formData.email} onChange={onChangeField}/>\r\n        </div>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <PasswordInput name={'password'} size={'default'} value={formData.password} onChange={onChangeField}/>\r\n        </div>\r\n        <Button type=\"primary\" size=\"medium\">\r\n          Войти\r\n        </Button>\r\n        <p className={\"text text_type_main-default text_color_inactive mt-20 mb-4\"}>\r\n          Вы — новый пользователь? <Link to=\"/register\" className={styles.link}>Зарегистрироваться</Link>\r\n        </p>\r\n        <p className={\"text text_type_main-default text_color_inactive\"}>\r\n          Забыли пароль? <Link to=\"/forgot-password\" className={styles.link}>Восстановить пароль</Link>\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {LoginPage};","import React, {ChangeEventHandler, FC, FormEventHandler, useState} from 'react';\r\n\r\nimport {useAppDispatch, useAppSelector} from \"../services/hooks\";\r\nimport {Link, Redirect} from 'react-router-dom';\r\nimport {Input, EmailInput, PasswordInput, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './register.module.css';\r\nimport {register} from \"../services/slices/user\";\r\n\r\ninterface IFormRegisterState {\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nconst RegisterPage:FC = () => {\r\n  const [formData, setFormData] = useState<IFormRegisterState>({\r\n    name: '',\r\n    email: '',\r\n    password: ''\r\n  });\r\n  const dispatch = useAppDispatch();\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n\r\n  const onChangeFormData: ChangeEventHandler = e => {\r\n    const element = e.target as HTMLInputElement;\r\n    setFormData({\r\n      ...formData,\r\n      [element.name]: element.value\r\n    });\r\n  }\r\n\r\n  if (isAuth) {\r\n    return (\r\n      <Redirect\r\n        to={{\r\n          pathname: '/'\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  const onSubmitForm: FormEventHandler = (e) => {\r\n    e.preventDefault();\r\n    dispatch(register({...formData}));\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.container} mt-15`}>\r\n      <form onSubmit={onSubmitForm}>\r\n        <h2 className={`text text_type_main-medium mt-30 mb-6`}>Регистрация</h2>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <Input\r\n            type={'text'}\r\n            placeholder={'Имя'}\r\n            name={'name'}\r\n            error={false}\r\n            value={formData.name}\r\n            errorText={'Ошибка'}\r\n            size={'default'}\r\n            onChange={onChangeFormData}\r\n          />\r\n        </div>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <EmailInput name={'email'} size={'default'} value={formData.email} onChange={onChangeFormData}/>\r\n        </div>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <PasswordInput name={'password'} size={'default'} value={formData.password} onChange={onChangeFormData}/>\r\n        </div>\r\n        <Button type=\"primary\" size=\"medium\">\r\n          Зарегистрироваться\r\n        </Button>\r\n        <p className={\"text text_type_main-default text_color_inactive mt-20 mb-4\"}>\r\n          Уже зарегистрированы? <Link to=\"/login\" className={styles.link}>Войти</Link>\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {RegisterPage};\r\n","import React, {ChangeEventHandler, FC, FormEventHandler, useState} from 'react';\r\nimport {useAppSelector} from \"../services/hooks\";\r\nimport {Link, Redirect, useHistory, useLocation} from 'react-router-dom';\r\nimport {EmailInput, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './forgot_password.module.css';\r\nimport {burgerAPI} from \"../services/utils\";\r\n\r\nconst ForgotPasswordPage:FC = () => {\r\n  const [email, setEmail] = useState('');\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  const onChange:ChangeEventHandler = e => {\r\n    const element = e.target as HTMLInputElement;\r\n    setEmail(element.value);\r\n  };\r\n\r\n  if (isAuth) {\r\n    return (\r\n      <Redirect to={\"/\"}/>\r\n    );\r\n  }\r\n\r\n  const onSubmitForm:FormEventHandler = (e) => {\r\n    e.preventDefault();\r\n    fetch(`${burgerAPI}/password-reset`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        email\r\n      })\r\n    }).then(response => response.json())\r\n      .then(result => {\r\n        if (result.success) {\r\n          history.replace(\"/reset-password\", {from: location});\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.container} mt-15`}>\r\n      <form onSubmit={onSubmitForm}>\r\n        <h2 className={`text text_type_main-medium mt-30 mb-6`}>Восстановление пароля</h2>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <EmailInput name={'email'} size={'default'} value={email} onChange={onChange}/>\r\n        </div>\r\n        <Button type=\"primary\" size=\"medium\">\r\n          Восстановить\r\n        </Button>\r\n        <p className={\"text text_type_main-default text_color_inactive mt-20\"}>\r\n          Вспомнили пароль? <Link to=\"/login\" className={styles.link}>Войти</Link>\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {ForgotPasswordPage};","import React, {ChangeEventHandler, FC, FormEventHandler, useState} from 'react';\r\nimport {Link, Redirect, useHistory, useLocation} from 'react-router-dom';\r\nimport {PasswordInput, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport {useAppSelector} from \"../services/hooks\";\r\nimport {ILocation} from \"../services/types\";\r\n\r\nimport styles from './reset_password.module.css';\r\nimport {burgerAPI} from \"../services/utils\";\r\n\r\nconst ResetPasswordPage:FC = () => {\r\n  const [password, setPassword] = useState<string>('');\r\n  const [token, setToken] = useState<string>('');\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n  const history = useHistory();\r\n  const location = useLocation<ILocation>();\r\n\r\n  const onChangePassword: ChangeEventHandler = e => {\r\n    const element = e.target as HTMLInputElement;\r\n    setPassword(element.value);\r\n  };\r\n\r\n  const onChangeToken: ChangeEventHandler = e => {\r\n    const element = e.target as HTMLInputElement;\r\n    setToken(element.value);\r\n  }\r\n\r\n  if (isAuth) {\r\n    return (\r\n      <Redirect to={\"/\"}/>\r\n    );\r\n  }\r\n\r\n  if (!location.state || (location.state && location.state.from && location.state.from.pathname !== '/forgot-password')) {\r\n    return (\r\n      <Redirect to={\"/forgot-password\"}/>\r\n    );\r\n  }\r\n\r\n  const onSubmitForm: FormEventHandler = async (e) => {\r\n    e.preventDefault();\r\n    fetch(`${burgerAPI}/password-reset/reset`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        password,\r\n        token\r\n      })\r\n    }).then(response => response.json())\r\n      .then(result => {\r\n        if (result.success) {\r\n          console.log(result.message);\r\n          history.replace(\"/login\")\r\n        } else if (result.message) {\r\n          console.log(result.message);\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.container} mt-15`}>\r\n      <form onSubmit={onSubmitForm}>\r\n        <h2 className={`text text_type_main-medium mt-30 mb-6`}>Восстановление пароля</h2>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <PasswordInput name={'password'} size={'default'} value={password} onChange={onChangePassword}/>\r\n        </div>\r\n        <div className={`${styles.wrapper} mb-6`}>\r\n          <Input\r\n            type={'text'}\r\n            placeholder={'Введите код из письма'}\r\n            name={'token'}\r\n            value={token}\r\n            error={false}\r\n            errorText={'Ошибка'}\r\n            onChange={onChangeToken}\r\n            size={'default'}\r\n          />\r\n        </div>\r\n        <Button type=\"primary\" size=\"medium\">\r\n          Сохранить\r\n        </Button>\r\n        <p className={\"text text_type_main-default text_color_inactive mt-20\"}>\r\n          Вспомнили пароль? <Link to=\"/login\" className={styles.link}>Войти</Link>\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {ResetPasswordPage};\r\n","import React, {\r\n    useEffect,\r\n    FormEventHandler,\r\n    ChangeEventHandler,\r\n    SyntheticEvent, FC\r\n} from 'react';\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {PasswordInput, EmailInput, Input, Button} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './ProfileForm.module.css';\r\nimport {getUserData, updateUserFormData, setUserData} from '../../services/slices/user';\r\n\r\nconst ProfileForm:FC = () => {\r\n  const {name, email, password} = useAppSelector(({user}) => user.form);\r\n  const formData = {name, email, password};\r\n  const dispatch = useAppDispatch();\r\n\r\n  useEffect(() => {\r\n      dispatch(getUserData());\r\n    },\r\n    [dispatch]);\r\n\r\n  const onFieldChange: ChangeEventHandler = e => {\r\n    const element = e.target as HTMLInputElement;\r\n    if (element.name === 'name' || element.name === 'email' || element.name === 'password') {\r\n        dispatch(updateUserFormData( {\r\n          [element.name]: element.value\r\n        }));\r\n    }\r\n  }\r\n\r\n  const onSubmitForm: FormEventHandler = async (e) => {\r\n    e.preventDefault();\r\n    dispatch(setUserData(formData));\r\n  }\r\n\r\n  const onCancelBtnClick: (() => void) | ((e: SyntheticEvent) => void) = (e) => {\r\n    e.preventDefault();\r\n    dispatch(getUserData());\r\n  }\r\n\r\n  return (\r\n    <form className={`${styles.form} mt-20 pb-20`} onSubmit={onSubmitForm}>\r\n      <div className={styles.input_wrapper}>\r\n        <Input value={formData.name} onChange={onFieldChange} name={\"name\"} type={\"text\"} placeholder={\"Имя\"}/>\r\n      </div>\r\n      <div className={styles.input_wrapper}>\r\n        <EmailInput value={formData.email} name={\"email\"} onChange={onFieldChange}/>\r\n      </div>\r\n      <div className={styles.input_wrapper}>\r\n        <PasswordInput value={formData.password} name={\"password\"} onChange={onFieldChange}/>\r\n      </div>\r\n      <div className={styles.buttons_wrapper}>\r\n        <Button type={\"primary\"} size={\"medium\"}>Сохранить</Button>\r\n        <Button type={\"secondary\"} size={\"medium\"} onClick={onCancelBtnClick}>Отмена</Button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default ProfileForm;","import React, {FC} from 'react';\r\nimport {useAppSelector} from \"../../services/hooks\";\r\nimport {CurrencyIcon} from '@ya.praktikum/react-developer-burger-ui-components';\r\n\r\nimport styles from './OrderListItem.module.css';\r\nimport {humanReadableDate} from \"../../services/utils\";\r\n\r\nimport {IIngredient} from \"../../services/types\";\r\nimport {IOrder} from \"../../services/types\";\r\n\r\ntype TOrderListItem = {\r\n  order: IOrder,\r\n  showStatus: boolean\r\n};\r\n\r\nconst OrderListItem:FC<TOrderListItem> = ({order, showStatus = false}) => {\r\n  const {ingredients, status, number, name, createdAt} = order;\r\n  const {data} = useAppSelector(({data}) => data);\r\n\r\n  if (data.length === 0) {\r\n    return (\r\n      <div className={'text text_type_main-medium'}>Загрузка...</div>\r\n    );\r\n  }\r\n\r\n  let total = 0;\r\n  let componentIconArr:Array<string> = [];\r\n  const showMore = ingredients.length > 6;\r\n  const extraCnt = ingredients.length - 6;\r\n  ingredients.slice(0, 6).forEach(ingredientId => {\r\n    let ingredient = data.find((component: IIngredient) => component._id === ingredientId);\r\n    if (!ingredient) {\r\n      console.log('Ошибка. Компонент не найден');\r\n      return;\r\n    }\r\n    total += ingredient.price;\r\n    componentIconArr.push(ingredient.image_mobile);\r\n  })\r\n\r\n  const statusText = (status: string) => {\r\n    const style:{color?: string} = {};\r\n    let text = ''\r\n    switch (status) {\r\n      case 'created':\r\n        text = 'Создан';\r\n        break;\r\n      case 'pending':\r\n        text = 'Готовится';\r\n        break;\r\n      case 'done':\r\n        text = 'Выполнен';\r\n        style.color = '#00CCCC';\r\n        break;\r\n      default:\r\n    }\r\n    return (\r\n      <p className=\"text text_type_main-default mb-6\" style={style}>{text}</p>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.order} mr-3 p-6`}>\r\n      <div className={`${styles.order_number_date} mb-6`}>\r\n        <span className={'text text_type_main-default'}>#{number}</span>\r\n        <span\r\n          className={'text text_type_main-default text_color_inactive'}>{humanReadableDate(new Date(createdAt))}</span>\r\n      </div>\r\n      <p className={`text text_type_main-medium ${showStatus ? 'mb-2' : 'mb-6'}`}>{name}</p>\r\n      {showStatus && statusText(status)}\r\n      <div className={styles.order_components_total}>\r\n        <div className={styles.order_icons}>\r\n          {componentIconArr.map((img, index) => (\r\n            <img\r\n              className={`${styles.order_component_icon} ${index === 5 && showMore && styles.order_component_icon_more}`}\r\n              src={img}\r\n              key={index}\r\n              style={{zIndex: 10 - index}}\r\n              alt=\"\"\r\n            />\r\n          ))}\r\n          {showMore && <div className={`text text_type_main-default ${styles.more_items}`}>+{extraCnt}</div>}\r\n        </div>\r\n        <div className={styles.order_total}><p className={'text text_type_digits-default mr-2'}>{total}</p><CurrencyIcon\r\n          type=\"primary\"/></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default OrderListItem;","import React, {FC} from 'react';\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {Link, useLocation} from 'react-router-dom';\r\n\r\nimport OrderListItem from \"../OrderListItem/OrderListItem\";\r\nimport styles from './OrderList.module.css';\r\nimport {getData} from \"../../services/slices/burgerIngredients\";\r\nimport {dataURL} from '../../pages/home';\r\n\r\nimport {IOrder} from \"../../services/types\";\r\n\r\ntype TOrderList = {\r\n  orderList: Array<IOrder>;\r\n  showStatus: boolean;\r\n};\r\n\r\nconst OrderList:FC<TOrderList> = ({orderList, showStatus}) => {\r\n  const dispatch = useAppDispatch();\r\n  const {data, dataRequest} = useAppSelector(({data}) => data);\r\n  const location = useLocation();\r\n\r\n  React.useEffect(() => {\r\n    if (data.length === 0) {\r\n      dispatch(getData(dataURL));\r\n    }\r\n  }, [dispatch, data.length]);\r\n\r\n  return (\r\n    <>\r\n      {dataRequest\r\n        ? (<div className={'text text_type_main-large'}>Загрузка...</div>)\r\n        : (<ul className={styles.order_list}>\r\n          {orderList.map(order => (\r\n            <li key={order._id}>\r\n              <Link to={{\r\n                pathname: `${location.pathname}/${order._id}`,\r\n                state: {background: location}\r\n              }}>\r\n                <OrderListItem order={order} key={order._id} showStatus={showStatus}/>\r\n              </Link>\r\n            </li>\r\n          ))}\r\n        </ul>)}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default OrderList;","import React, {FC, useEffect} from 'react';\r\nimport {Route, Switch, Redirect, NavLink, useLocation, useHistory} from 'react-router-dom';\r\n\r\nimport {useAppDispatch, useAppSelector} from \"../services/hooks\";\r\nimport ProfileForm from \"../components/ProfileForm/ProfileForm\";\r\nimport styles from './profile.module.css';\r\nimport {logout} from \"../services/slices/user\";\r\nimport OrderList from \"../components/OrderList/OrderList\";\r\nimport OrderInfo from \"../components/OrderInfo/OrderInfo\";\r\nimport Modal from \"../components/Modal/Modal\";\r\nimport {\r\n  wsUserConnectionStart\r\n} from '../services/slices/wsUser';\r\n\r\nimport {ILocation} from \"../services/types\";\r\n\r\nconst ProfilePage: FC = () => {\r\n  const dispatch = useAppDispatch();\r\n  const {isAuth} = useAppSelector(({user}) => user);\r\n  const location = useLocation<ILocation>();\r\n  const history = useHistory();\r\n  const {orders, wsConnected} = useAppSelector(({ordersUser}) => ordersUser);\r\n\r\n  useEffect(() => {\r\n    if (!wsConnected) {\r\n      dispatch(wsUserConnectionStart());\r\n    }\r\n  }, [wsConnected, dispatch]);\r\n\r\n  const onLogoutClick = () => {\r\n    dispatch(logout());\r\n  }\r\n\r\n  if (!isAuth) {\r\n    return (\r\n      <Redirect to={\"/login\"}/>\r\n    );\r\n  }\r\n\r\n  const background = history.action === 'PUSH' && location.state && location.state.background;// location.state;\r\n\r\n  return (\r\n    <ul className={`${styles.wrapper} mt-10`}>\r\n      <Switch location={background || location}>\r\n        <Route path={'/profile/orders/:orderId'} exact={true}>\r\n          <OrderInfo/>\r\n        </Route>\r\n        <Route path={'/'}>\r\n          <li className={`${styles.left_panel} mt-20`}>\r\n            <ul className={\"pb-20\"}>\r\n              <li className={styles.nav_link}>\r\n                <NavLink to=\"/profile\" exact={true} className={\"text text_type_main-medium text_color_inactive\"}\r\n                         activeStyle={{\r\n                           color: \"white\"\r\n                         }}>\r\n                  Профиль\r\n                </NavLink>\r\n              </li>\r\n              <li className={styles.nav_link}>\r\n                <NavLink to=\"/profile/orders\" className={\"text text_type_main-medium text_color_inactive\"}\r\n                         activeStyle={{\r\n                           color: \"white\"\r\n                         }}>\r\n                  История заказов\r\n                </NavLink>\r\n              </li>\r\n              <li className={styles.nav_link}>\r\n                <button className={\"text text_type_main-medium text_color_inactive\"} onClick={onLogoutClick}>Выход\r\n                </button>\r\n              </li>\r\n            </ul>\r\n            <p className={`${styles.description} text text_type_main-default text_color_inactive`}>В этом разделе вы\r\n              можете\r\n              изменить свои персональные данные</p>\r\n          </li>\r\n          <li className={`${styles.right_panel} mb-5`}>\r\n            <Switch location={background || location}>\r\n              <Route path=\"/profile\" exact={true}>\r\n                <ProfileForm/>\r\n              </Route>\r\n              <Route path=\"/profile/orders\" exact={true}>\r\n                <OrderList orderList={orders} showStatus={true}/>\r\n              </Route>\r\n            </Switch>\r\n          </li>\r\n        </Route>\r\n      </Switch>\r\n      {background && (\r\n        <Modal title=\"Заказ\" onClose={() => {\r\n          history.push('/profile/orders');\r\n        }}>\r\n          <OrderInfo/>\r\n        </Modal>\r\n      )}\r\n    </ul>\r\n  );\r\n}\r\n\r\nexport {ProfilePage};\r\n","import React, {FC} from 'react';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport styles from './not-found.module.css';\r\n\r\nconst NotFound404:FC = () => {\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <h1 className={\"text text_type_main-large\"}>Упс! Ошибка 404</h1>\r\n      <p className={\"text text_type_main-medium text_color_inactive\"}>Запрашиваемой страницы не существует</p>\r\n      <br/>\r\n      <br/>\r\n      <p className={\"text text_type_main-small\"}>\r\n        Проверьте адрес или вернитесь на <Link to='/' className={\"text_color_inactive\"}>домашнюю страницу</Link>\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {NotFound404};","import React, {FC, useEffect} from 'react';\r\nimport {useAppDispatch, useAppSelector} from \"../services/hooks\";\r\nimport styles from \"./feed.module.css\";\r\nimport OrderList from \"../components/OrderList/OrderList\";\r\nimport {wsConnectionStart} from '../services/slices/ws';\r\n\r\nimport {IOrder} from \"../services/types\";\r\n\r\n\r\nconst Feed:FC = () => {\r\n  const dispatch = useAppDispatch();\r\n  const ordersState = useAppSelector(({orders}) => orders);\r\n  const ordersResponse = ordersState.orders;\r\n  const {wsConnected} = ordersState;\r\n\r\n  useEffect(() => {\r\n    if (!wsConnected) {\r\n      dispatch(wsConnectionStart());\r\n    }\r\n  }, [wsConnected, dispatch]);\r\n  const {total, totalToday} = ordersResponse;\r\n\r\n  const orderList = ordersResponse.orders || [];\r\n\r\n  const orders: {\r\n    done: Array<number>;\r\n    pending: Array<number>;\r\n  } = {\r\n    done: [],\r\n    pending: []\r\n  };\r\n\r\n  orderList.forEach((order: IOrder) => {\r\n    if (order.status === 'done' || order.status === 'pending') {\r\n      orders[order.status].push(order.number);\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div className={`${styles.wrapper} mb-5`}>\r\n      <h1 className={\"text text_type_main-large mb-5\"}>Лента заказов</h1>\r\n      <section className={styles.feed_wrapper}>\r\n        <div className={styles.feed_inner}>\r\n          <OrderList orderList={orderList} showStatus={false}/>\r\n        </div>\r\n        <div className={styles.feed_inner}>\r\n          <ul className={`${styles.feed_order_status}`}>\r\n            <li className={styles.feed_order_status_type}>\r\n              <h2 className={`text text_type_main-medium mb-6`}>Готовы:</h2>\r\n              <ul className={styles.feed_order_status_type_list}>\r\n                {orders.done.map(order => (\r\n                  <li className={`text text_type_digits-default ${styles.feed_order_cyan_colored}`}\r\n                      key={order}>{order}</li>\r\n                ))}\r\n              </ul>\r\n            </li>\r\n            <li className={styles.feed_order_status_type}>\r\n              <h2 className={`text text_type_main-medium mb-6`}>В работе:</h2>\r\n              <ul className={styles.feed_order_status_type_list}>\r\n                {orders.pending.map(order => (\r\n                  <li className={`text text_type_digits-default`} key={order}>{order}</li>\r\n                ))}\r\n              </ul>\r\n            </li>\r\n          </ul>\r\n          <p className={`text text_type_main-medium ${styles.text_shadow}`}>Выполнено за все время:</p>\r\n          <p className={`text text_type_digits-large mb-15 ${styles.text_shadow}`}>{total}</p>\r\n          <p className={`text text_type_main-medium ${styles.text_shadow}`}>Выполнено за сегодня:</p>\r\n          <p className={`text text_type_digits-large ${styles.text_shadow}`}>{totalToday}</p>\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {Feed};","import React, {FC, useEffect} from 'react';\r\nimport {Route, Switch, useHistory, useLocation} from 'react-router-dom';\r\n\r\nimport {useAppDispatch, useAppSelector} from \"../../services/hooks\";\r\nimport {orderClose} from '../../services/slices';\r\nimport AppHeader from '../AppHeader/AppHeader';\r\nimport Modal from '../Modal/Modal';\r\nimport OrderDetails from '../OrderDetails/OrderDetails';\r\nimport IngredientDetails from '../IngredientDetails/IngredientDetails';\r\nimport ProtectedRoute from \"../ProtectedRoute/ProtectedRoute\";\r\nimport OrderInfo from \"../OrderInfo/OrderInfo\";\r\n\r\nimport {\r\n  HomePage,\r\n  LoginPage,\r\n  RegisterPage,\r\n  ForgotPasswordPage,\r\n  ResetPasswordPage,\r\n  NotFound404,\r\n  ProfilePage,\r\n  Feed\r\n} from '../../pages'\r\n\r\nimport Loader from \"react-loader-spinner\";\r\nimport styles from \"./App.module.css\"\r\nimport {updateUserName} from \"../../services/slices/user\";\r\nimport {ILocation} from \"../../services/types\";\r\n\r\nconst App: FC =() => {\r\n  const dispatch = useAppDispatch();\r\n  const history = useHistory();\r\n  const location = useLocation<ILocation>();\r\n  const {orderRequest, orderFailed, orderNumber} = useAppSelector(({order}) => order);\r\n  const {isAuth, name} = useAppSelector(({user}) => user);\r\n\r\n  useEffect(() => {\r\n    if (isAuth && !name) {\r\n      dispatch(updateUserName());\r\n    }\r\n  }, [dispatch, isAuth, name]);\r\n\r\n  const handleCloseModal = () => {\r\n    history.push('/');\r\n  }\r\n\r\n  const handleCloseOrderModal = () => {\r\n    dispatch(orderClose());\r\n  }\r\n\r\n  const background = history.action === 'PUSH' && location.state && location.state.background;\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <AppHeader/>\r\n      <main>\r\n        <Switch location={background || location}>\r\n          <Route path=\"/\" exact={true}>\r\n            <HomePage/>\r\n          </Route>\r\n          <Route path=\"/login\" exact={true}>\r\n            <LoginPage/>\r\n          </Route>\r\n          <Route path=\"/register\" exact={true}>\r\n            <RegisterPage/>\r\n          </Route>\r\n          <Route path=\"/forgot-password\" exact={true}>\r\n            <ForgotPasswordPage/>\r\n          </Route>\r\n          <Route path=\"/reset-password\" exact={true}>\r\n            <ResetPasswordPage/>\r\n          </Route>\r\n          <ProtectedRoute path=\"/profile\">\r\n            <ProfilePage/>\r\n          </ProtectedRoute>\r\n          <Route path={\"/ingredients/:ingredientId\"}>\r\n            <IngredientDetails className={\"mt-30\"} title={\"Детали ингредиента\"}/>\r\n          </Route>\r\n          <Route path={\"/feed\"} exact={true}>\r\n            <Feed/>\r\n          </Route>\r\n          <Route path={\"/feed/:orderId\"} exact={true}>\r\n            <OrderInfo className={\"mt-30\"}/>\r\n          </Route>\r\n          <Route>\r\n            <NotFound404/>\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n      {background && (\r\n        <Switch>\r\n          <Route path={\"/ingredients/:ingredientId\"} exact={true}>\r\n            <Modal title=\"Детали ингредиента\" onClose={handleCloseModal}>\r\n              <IngredientDetails/>\r\n            </Modal>\r\n          </Route>\r\n          <Route path={\"/feed/:orderId\"} exact={true}>\r\n            <Modal title={'Заказ'} onClose={() => {\r\n              history.push('/feed');\r\n            }}>\r\n              <OrderInfo/>\r\n            </Modal>\r\n          </Route>\r\n        </Switch>\r\n      )}\r\n      {orderRequest && (<div className={styles.loader}>\r\n        <Loader\r\n          type=\"Oval\"\r\n          color=\"#9C64D9\"\r\n          height={200}\r\n          width={200}\r\n        />\r\n      </div>)\r\n      }\r\n      {orderNumber && !orderRequest && (\r\n        <Modal title=\"\" onClose={handleCloseOrderModal}>\r\n          {!orderFailed\r\n            ? (<OrderDetails orderNumber={orderNumber}/>)\r\n            : (<span\r\n              className=\"text text_type_main-medium\">Не удалось оформить заказ. Пожалуйста, попробуйте позже.</span>)\r\n          }\r\n        </Modal>\r\n      )\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import {getCookie} from '../utils';\r\nimport {Middleware} from \"redux\";\r\nimport {ActionCreatorWithoutPayload, ActionCreatorWithPayload} from \"@reduxjs/toolkit\";\r\n\r\nexport const socketMiddleware = (wsUrl: string,\r\n                                 wsActions: { [key: string]: ActionCreatorWithoutPayload |  ActionCreatorWithPayload<any, string> },\r\n                                 {checkToken}: {checkToken?: boolean}):Middleware => {\r\n  return (store) => {\r\n    let socket: WebSocket | null = null;\r\n\r\n    return (next) => (action) => {\r\n      const {dispatch} = store;\r\n      const {\r\n        wsConnectionStart,\r\n        wsConnectionSuccess,\r\n        wsConnectionClosed,\r\n        wsConnectionError,\r\n        wsGetMessage\r\n      } = wsActions;\r\n\r\n      if (wsConnectionStart.match(action)) {\r\n        socket = new WebSocket(`${wsUrl}${checkToken ? ('?token=' + getCookie('accessToken')) : ''}`);\r\n      }\r\n      if (socket) {\r\n        socket.onopen = () => {\r\n          dispatch(wsConnectionSuccess({}));\r\n        };\r\n\r\n        socket.onerror = () => {\r\n          dispatch(wsConnectionError({}));\r\n        };\r\n\r\n        socket.onmessage = event => {\r\n          const {data} = event;\r\n          const parsedData = JSON.parse(data);\r\n          const {success, ...restParsedData} = parsedData;\r\n\r\n          dispatch(wsGetMessage(restParsedData))\r\n        };\r\n\r\n        socket.onclose = () => {\r\n          dispatch(wsConnectionClosed({}));\r\n        };\r\n      }\r\n\r\n      next(action);\r\n    };\r\n  };\r\n};\r\n","import thunk/*, {ThunkAction}*/ from 'redux-thunk';\r\nimport {configureStore} from '@reduxjs/toolkit';\r\n// import {Action, ActionCreator} from 'redux';\r\n\r\nimport rootReducer from './slices';\r\nimport {socketMiddleware} from './middleware'\r\n\r\nimport {\r\n  wsConnectionStart,\r\n  wsConnectionSuccess,\r\n  wsConnectionClosed,\r\n  wsConnectionError,\r\n  wsGetMessage\r\n} from './slices/ws';\r\n\r\nimport {\r\n  wsUserConnectionStart,\r\n  wsUserConnectionSuccess,\r\n  wsUserConnectionClosed,\r\n  wsUserConnectionError,\r\n  wsUserGetMessage\r\n} from './slices/wsUser';\r\n\r\nconst wsUrl = 'wss://norma.nomoreparties.space/orders/all';\r\nconst wsUserUrl = 'wss://norma.nomoreparties.space/orders';\r\n\r\nconst initStore = () => configureStore({\r\n  reducer: rootReducer,\r\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(thunk)\r\n    .concat(socketMiddleware(wsUrl, {\r\n      wsConnectionStart,\r\n      wsConnectionSuccess,\r\n      wsConnectionClosed,\r\n      wsConnectionError,\r\n      wsGetMessage\r\n    }, {checkToken: false}))\r\n    .concat(socketMiddleware(wsUserUrl, {\r\n        wsConnectionStart: wsUserConnectionStart,\r\n        wsConnectionSuccess: wsUserConnectionSuccess,\r\n        wsConnectionClosed: wsUserConnectionClosed,\r\n        wsConnectionError: wsUserConnectionError,\r\n        wsGetMessage: wsUserGetMessage\r\n      }, {checkToken: true})\r\n    ),\r\n  devTools: process.env.NODE_ENV !== 'production'\r\n});\r\n\r\nexport const store = initStore();\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppDispatch = typeof store.dispatch;\r\n\r\n/***\r\n Возникли проблемы, от наставника была информация:\r\n \"А тип AppThunk  с тулкитом похоже совсем не понадобится\"\r\n\r\n Update: От наставника так и не удалось получить совет/подсказку, а самостоятельно сделать правильный AppThunk не вышло.\r\n         Поэтому переделал все thunk-функции c использованием createAsyncThunk из redux-toolkit\r\n\r\n export type AppThunk<TReturn = void> = ActionCreator<\r\n      ThunkAction<TReturn, Action, RootState, Action>\r\n     >;\r\n***/","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './normalize.css';\r\nimport './index.css';\r\nimport App from './components/App/App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nimport {Provider} from 'react-redux';\r\n\r\nimport {DndProvider} from \"react-dnd\";\r\nimport {HTML5Backend} from \"react-dnd-html5-backend\";\r\nimport {BrowserRouter as Router} from 'react-router-dom';\r\n\r\nimport {store} from \"./services/store\";\r\n\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <DndProvider backend={HTML5Backend}>\r\n        <Router>\r\n          <App/>\r\n        </Router>\r\n      </DndProvider>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"IngredientDetails_container__2nnnN\",\"description\":\"IngredientDetails_description__1qgMP\",\"name\":\"IngredientDetails_name__2Yrbr\",\"info-list\":\"IngredientDetails_info-list__3Bc1z\",\"info-list-item\":\"IngredientDetails_info-list-item__2W67P\",\"nutrition-type-name\":\"IngredientDetails_nutrition-type-name__12XoJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"OrderInfo_wrapper__HIFyy\",\"align_center\":\"OrderInfo_align_center__2ujBS\",\"cyan_color\":\"OrderInfo_cyan_color__1L1bs\",\"composition\":\"OrderInfo_composition__3s0pn\",\"ingredient_info\":\"OrderInfo_ingredient_info__28LA_\",\"ingredient_icon_name\":\"OrderInfo_ingredient_icon_name__2HpcM\",\"ingredient_icon\":\"OrderInfo_ingredient_icon__1L5FD\",\"ingredient_qty_price\":\"OrderInfo_ingredient_qty_price__9lvCg\",\"time_total\":\"OrderInfo_time_total__2SjBu\",\"total\":\"OrderInfo_total__2FMko\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"AppHeader_header__1qooX\",\"nav-header\":\"AppHeader_nav-header__39zfP\",\"nav-list\":\"AppHeader_nav-list__27bZC\",\"nav-item\":\"AppHeader_nav-item__80qAG\",\"nav-item-active\":\"AppHeader_nav-item-active__274z6\",\"header-personal-area\":\"AppHeader_header-personal-area__3bcPI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"order\":\"OrderListItem_order__vjVlP\",\"order_number_date\":\"OrderListItem_order_number_date__1bm2i\",\"order_components_total\":\"OrderListItem_order_components_total__2tKRF\",\"order_total\":\"OrderListItem_order_total__17EGc\",\"order_icons\":\"OrderListItem_order_icons__2YtPK\",\"order_component_icon\":\"OrderListItem_order_component_icon__1KAbn\",\"order_component_icon_more\":\"OrderListItem_order_component_icon_more__3bZip\",\"more_items\":\"OrderListItem_more_items__36vj_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"profile_wrapper__1RIYZ\",\"left_panel\":\"profile_left_panel___VosU\",\"right_panel\":\"profile_right_panel__2dpqB\",\"nav_link\":\"profile_nav_link__1u0TF\",\"description\":\"profile_description__3-1tk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burger-ingredients\":\"BurgerIngredients_burger-ingredients__1sp_z\",\"burger-ingredients-tab\":\"BurgerIngredients_burger-ingredients-tab__1dsj3\",\"burger-ingredients-type-list\":\"BurgerIngredients_burger-ingredients-type-list__3c587\",\"burger-ingredients-type-item\":\"BurgerIngredients_burger-ingredients-type-item__1h2C7\",\"burger-ingredients-list\":\"BurgerIngredients_burger-ingredients-list__3qgEi\",\"burger-ingredients-item\":\"BurgerIngredients_burger-ingredients-item__5lrZs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burger-ingredient\":\"BurgerIngredient_burger-ingredient__1sx7O\",\"burger-ingredient-cnt\":\"BurgerIngredient_burger-ingredient-cnt__38M82\",\"burger-ingredient-img\":\"BurgerIngredient_burger-ingredient-img__eTPwi\",\"burger-ingredient-price\":\"BurgerIngredient_burger-ingredient-price__6AwWl\",\"burger-ingredient-name\":\"BurgerIngredient_burger-ingredient-name__1mDU8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"login_container__29a-_\",\"wrapper\":\"login_wrapper__34HHk\",\"link\":\"login_link__2SSU9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"register_container__36gKf\",\"wrapper\":\"register_wrapper__Ns7zG\",\"link\":\"register_link__W0QKo\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"ProfileForm_form__1GdsD\",\"input_wrapper\":\"ProfileForm_input_wrapper__1JSm4\",\"buttons_wrapper\":\"ProfileForm_buttons_wrapper__15zaM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"App_wrapper__3ajZr\",\"loader\":\"App_loader__20FVw\",\"loader_no_offset_top\":\"App_loader_no_offset_top__2nnK9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"OrderDetails_container__q2XTd\",\"number\":\"OrderDetails_number__3p402\",\"small-text\":\"OrderDetails_small-text__DwPZj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burger-constructor\":\"BurgerConstructor_burger-constructor__1Jp-a\",\"burger-constructor-list\":\"BurgerConstructor_burger-constructor-list__1nRJb\",\"burger-constructor-summary-and-offer-btn\":\"BurgerConstructor_burger-constructor-summary-and-offer-btn__1ktxC\",\"burger-constructor-summary\":\"BurgerConstructor_burger-constructor-summary__1CbkW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section-make-burger\":\"home_section-make-burger__2slKp\",\"section-make-burger-list\":\"home_section-make-burger-list__2HaU9\",\"section-make-burger-item\":\"home_section-make-burger-item__3uWru\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"reset_password_container__Laq4u\",\"wrapper\":\"reset_password_wrapper__1oCOS\",\"link\":\"reset_password_link__S4KZD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"forgot_password_container__3IQgW\",\"wrapper\":\"forgot_password_wrapper__XWdth\",\"link\":\"forgot_password_link__2VXa3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"inner\":\"Modal_inner__f99lF\",\"header\":\"Modal_header__wBDdw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burger-constructor-list-item\":\"BurgerConstructorItem_burger-constructor-list-item__tqS1H\",\"burger-constructor-list-item-inner\":\"BurgerConstructorItem_burger-constructor-list-item-inner__2K8zV\"};"],"sourceRoot":""}